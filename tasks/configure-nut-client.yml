- name: copy config file
  template:
    src: upsmon.conf.j2
    dest: /etc/nut/upsmon.conf
    owner: nut
    group: nut
    mode: 0644
  notify:
  - restart nut daemon

- name: "get last scripts version"
  get_url:
    url: "{{item}}"
    dest: /usr/local/bin/{{item|basename}}
    owner: root
    group: root
    mode: 0755
  loop: 
    - https://raw.githubusercontent.com/belgotux/nutNotify/master/nutShutdown.sh
    - https://raw.githubusercontent.com/belgotux/nutNotify/master/nutNotify.sh
    - https://raw.githubusercontent.com/belgotux/nutNotify/master/nutNotifyBoot.sh
    - https://raw.githubusercontent.com/belgotux/nutNotify/master/nutNotifyFct.sh


- name: link to download config file
  debug:
    msg: "Please take last conf file example to put in 'files/nutNotify/nutNotify.conf' folder https://github.com/belgotux/nutNotify/blob/master/nutNotify.conf.txt"

# TODO lazy need to do template file and vars
- name: "copy config"
  copy:
    src: "{{item}}"
    dest: /usr/local/etc/{{item|basename}}
    owner: root
    group: root
    mode: 0755
  loop: [nutNotify/nutNotify.conf]

- name: Create log folder
  file:
    path: "/var/log/nutNotify"
    owner: "nut"
    group: "nut"
    mode: 0775
    state: directory